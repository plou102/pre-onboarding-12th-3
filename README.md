# í”„ë¦¬ì˜¨ë³´ë”© ê²€ìƒ‰ì°½ ë§Œë“¤ê¸°

ê²€ìƒ‰ì°½ êµ¬í˜„ + ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„ + ìºì‹± ê¸°ëŠ¥ êµ¬í˜„

<br />

## ëª©ì°¨

- [ğŸ¼ ë§Œë“  ì‚¬ëŒ](#-ë§Œë“ -ì‚¬ëŒ)
- [ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ](#-ê¸°ìˆ -ìŠ¤íƒ)
- [ğŸ’» ì‹¤í–‰ ë°©ë²•](#-ì‹¤í–‰-ë°©ë²•)
- [ğŸ“‚ í´ë” êµ¬ì¡°](#-í´ë”-êµ¬ì¡°)
- [ğŸ“š ê³¼ì œ ìˆ˜í–‰ ë‚´ìš©](#-ê³¼ì œ-ìˆ˜í–‰-ë‚´ìš©)
  - [ì§ˆí™˜ëª… ê²€ìƒ‰ì‹œ API í˜¸ì¶œ í†µí•´ì„œ ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„](#ì§ˆí™˜ëª…-ê²€ìƒ‰ì‹œ-api-í˜¸ì¶œ-í†µí•´ì„œ-ê²€ìƒ‰ì–´-ì¶”ì²œ-ê¸°ëŠ¥-êµ¬í˜„)
  - [API í˜¸ì¶œë³„ë¡œ ë¡œì»¬ ìºì‹± êµ¬í˜„](#api-í˜¸ì¶œë³„ë¡œ-ë¡œì»¬-ìºì‹±-êµ¬í˜„)
  - [API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì´ëŠ” ì „ëµ ìˆ˜ë¦½ ë° ì‹¤í–‰](#api-í˜¸ì¶œ-íšŸìˆ˜ë¥¼-ì¤„ì´ëŠ”-ì „ëµ-ìˆ˜ë¦½-ë°-ì‹¤í–‰)
  - [í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì¶”ì²œ ê²€ìƒ‰ì–´ë“¤ë¡œ ì´ë™ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„](#í‚¤ë³´ë“œë§Œìœ¼ë¡œ-ì¶”ì²œ-ê²€ìƒ‰ì–´ë“¤ë¡œ-ì´ë™-ê°€ëŠ¥í•˜ë„ë¡-êµ¬í˜„)

## ğŸ¼ ë§Œë“  ì‚¬ëŒ

- ë°•ì •ë¯¼

<br />

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

<img src="https://img.shields.io/badge/React-61DAFB?style=flat&logo=react&logoColor=black"> <img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat&logo=javascript&logoColor=black"> <img src="https://img.shields.io/badge/Axios-5A29E4?style=flat&logo=axios&logoColor=white"> <img src="https://img.shields.io/badge/Styled Components-DB7093?style=flat&logo=styled-components&logoColor=white"> <img src="https://img.shields.io/badge/React Router-CA4245?style=flat&logo=react router&logoColor=white">

<img src="https://img.shields.io/badge/ESlint-4B32C3?style=flat&logo=eslint&logoColor=white"> <img src="https://img.shields.io/badge/Prettier-F7B93E?style=flat&logo=prettier&logoColor=black">

<br />

## ğŸ’» ì‹¤í–‰ ë°©ë²•

[api repo](https://github.com/walking-sunset/assignment-api)

```zsh
$ npm install
$ npm start
```

- api repoì™€ í•´ë‹¹ repo ëª¨ë‘ git cloneí›„, ìœ„ì˜ ëª…ë ¹ì–´ë¥¼ ìˆœì„œëŒ€ë¡œ ì‹¤í–‰í•˜ë©´ í”„ë¡œì íŠ¸ë¥¼ ì´ìš©í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br />

## ğŸ“‚ í´ë” êµ¬ì¡°

```
ğŸ“¦pre-onboarding-12th-3
 â”ƒ
 â”£ ğŸ“‚src
 â”ƒ â”£ ğŸ“‚api
 â”ƒ â”ƒ â”— ğŸ“œhttp.js
 â”ƒ â”£ ğŸ“‚components
 â”ƒ â”ƒ â”£ ğŸ“œRecommendedWord.jsx
 â”ƒ â”ƒ â”— ğŸ“œSearchInput.jsx
 â”ƒ â”£ ğŸ“‚constants
 â”ƒ â”ƒ â”— ğŸ“œcache.js
 â”ƒ â”£ ğŸ“‚context
 â”ƒ â”ƒ â”£ ğŸ“œKeywordContext.jsx
 â”ƒ â”ƒ â”— ğŸ“œListContext.jsx
 â”ƒ â”£ ğŸ“‚hooks
 â”ƒ â”ƒ â”— ğŸ“œuseKeyEvent.js
 â”ƒ â”£ ğŸ“‚pages
 â”ƒ â”ƒ â”— ğŸ“œMain.jsx
 â”ƒ â”£ ğŸ“‚utils
 â”ƒ â”ƒ â”— ğŸ“œRemoveSession.js
 â”ƒ â”£ ğŸ“œApp.css
 â”ƒ â”£ ğŸ“œApp.js
 â”ƒ â”£ ğŸ“œindex.css
 â”ƒ â”— ğŸ“œindex.js
 â”£ ğŸ“œ.eslintrc.js
 â”£ ğŸ“œ.gitignore
 â”£ ğŸ“œ.prettierrc.js
 â”£ ğŸ“œREADME.md
 â”£ ğŸ“œjsconfig.json
 â”£ ğŸ“œpackage-lock.json
 â”— ğŸ“œpackage.json
```

<br />

## ğŸ“š ê³¼ì œ ìˆ˜í–‰ ë‚´ìš©

### ì§ˆí™˜ëª… ê²€ìƒ‰ì‹œ API í˜¸ì¶œ í†µí•´ì„œ ê²€ìƒ‰ì–´ ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„

- ê²€ìƒ‰ì–´ê°€ ì—†ì„ ì‹œ "ê²€ìƒ‰ì–´ ì—†ìŒ" í‘œì¶œ

<img src="https://github.com/plou102/pre-onboarding-12th-2/assets/107393773/6f32c0db-b40f-4fc2-8a6b-9ae68b6527a3" width="600" height="400" />

<br /><br />

- `input`ì— ì…ë ¥ë˜ëŠ” í…ìŠ¤íŠ¸ì— ë”°ë¼ APIë¥¼ í˜¸ì¶œí•˜ë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- API í˜¸ì¶œì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ëŠ” `state`ì— ì €ì¥í•œ í›„ ë³´ì—¬ì£¼ë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
// src/context/ListContext.jsx

const [searchList, setSearchList] = useState([]);

const getData = async value => {

      (...)

      const list = await getSearchData(value);
      setSearchList(list);
    }
  };
```
```js
// src/pages/Main.jsx

return (

  (...)

      <SearchResultList ref={listRef} display={`${searchWord === ''}`}>
        <p>ì¶”ì²œê²€ìƒ‰ì–´</p>
        {searchList.length > 0 ? (
          searchList.map((item, idx) => {
            return (
              <RecommendedWord key={item.sickCd} item={item} idx={idx} focusIndex={focusIndex} />
            );
          })
        ) : (
          <p>ê²€ìƒ‰ì–´ê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
        )}
      </SearchResultList>
);
```

<br />

### API í˜¸ì¶œë³„ë¡œ ë¡œì»¬ ìºì‹± êµ¬í˜„

- ìºì‹± ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš© ê¸ˆì§€
- expire timeì„ êµ¬í˜„í•  ê²½ìš° ê°€ì‚°ì 

<img src="https://github.com/plou102/pre-onboarding-12th-2/assets/107393773/76db15c0-b63d-4b15-8c97-dd91df6e192f" width="700" height="400" />
<img src="https://github.com/plou102/pre-onboarding-12th-2/assets/107393773/0ad846a4-4434-48dc-b867-2a6ccc17128f" width="700" height="400" />

<br /><br />

- ë¡œì»¬ ìºì‹±ì„ êµ¬í˜„í•˜ê¸° ìœ„í•´ `SessionStorage`ë¥¼ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤.
- ìºì‹œ `Expire time`ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
// src/constants/cache.js

export const EXPIRE_TIME = 1000 * 60 * 5; // 5ë¶„
```

```js
// src/api/http.js

import { EXPIRE_TIME } from 'constants/cache';

const now = new Date();
const expiry = now.getTime() + EXPIRE_TIME;

export const getSearchData = async keyword => {
  return await axios
    (...)
    .then(res => {
      const sessionData = {
        list: res.data,
        time: expiry,
      }; // ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ì™€ ì‹œê°„ì„ ê°ì²´ë¡œ ë‹´ì•„ SessionStorageì— ì €ì¥
      sessionStorage.setItem(`${keyword}`, JSON.stringify(sessionData));

    (...)

    .finally(console.info('calling api')); // apiê°€ í˜¸ì¶œë  ë•Œë§ˆë‹¤ console.info ì¶œë ¥
};
```

```js
// src/utils/RemoveSession.js

export const DeleteSession = value => {
  const sessionData = sessionStorage.getItem(`${value}`); // ê²€ìƒ‰í•˜ëŠ” í‚¤ì›Œë“œê°€ Storageì— ìˆëŠ”ì§€ í™•ì¸

  const item = JSON.parse(sessionData);
  const now = new Date().getTime();

  if (now > item.time) {
    // í˜„ì¬ ì‹œê°„ì´ Storageì˜ value-time ë³´ë‹¤ í¬ë‹¤ë©´ ë°ì´í„° ì‚­ì œ ì‹¤í–‰ í›„ api í˜¸ì¶œ
    sessionStorage.removeItem(`${value}`);
    return true;
  }

  return false; // ifë¬¸ì´ ì‹¤í–‰ë˜ì§€ ì•Šì•˜ë‹¤ë©´ false ë°˜í™˜
};
```

<br />

### API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì¤„ì´ëŠ” ì „ëµ ìˆ˜ë¦½ ë° ì‹¤í–‰

<img src="https://github.com/plou102/pre-onboarding-12th-2/assets/107393773/2d25763c-aa9e-404d-a04a-95476b7dca15" width="700" height="400" />

<br /><br />

- `lodash`ë¼ì´ë¸ŒëŸ¬ë¦¬ì˜ `debounce`ë¥¼ ì‚¬ìš©í•˜ì—¬ 1ì´ˆë§ˆë‹¤ apië¥¼ í˜¸ì¶œí•  ìˆ˜ ìˆë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
// src/pages/Main.jsx

import { debounce } from 'lodash';

const Debounce = useCallback(
  debounce(value => getData(value), 1000), // debounceëŠ” 1ì´ˆë™ì•ˆ ëˆ„ì ëœ ì´ë²¤íŠ¸ë¥¼ í•œë²ˆì— ì‹¤í–‰í•˜ê¸° ë•Œë¬¸ì— useCallbackì„ ì‚¬ìš©
  [],
);

useEffect(() => {

  (...)

  Debounce(searchWord);
  }, [searchWord]);
```

<br />
  
### í‚¤ë³´ë“œë§Œìœ¼ë¡œ ì¶”ì²œ ê²€ìƒ‰ì–´ë“¤ë¡œ ì´ë™ ê°€ëŠ¥í•˜ë„ë¡ êµ¬í˜„

<img src="https://github.com/plou102/pre-onboarding-12th-2/assets/107393773/a9ec047e-4f5d-4f5d-862e-d57231a67319" width="700" height="400" />

<br /><br />

- ìœ„, ì•„ë˜ ë°©í–¥í‚¤ë¡œ ì´ë™í•˜ì—¬ ì¶”ì²œ ê²€ìƒ‰ì–´ë“¤ë¡œ ì´ë™ì´ ê°€ëŠ¥í•˜ë„ë¡ í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ì„ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.
- ì´ë™í•  ë•Œë§ˆë‹¤ `input`ì— ìë™ì™„ì„±ì´ ë˜ë„ë¡ êµ¬í˜„í•˜ì˜€ìŠµë‹ˆë‹¤.

```js
// src/components/SearchInput.jsx

  const KeyHandler = useKeyEvent({ listRef, setIsAutoWord });
  const InputKeyUp = e => {
    const handler = KeyHandler[e.key];

    if (handler) handler();
  };

return (

  (...)

  <DiseaseInput
    type="text"
    placeholder="ì§ˆí™˜ëª…ì„ ì…ë ¥í•´ ì£¼ì„¸ìš”"
    ref={focusRef}
    onChange={InputChange}
    onKeyUp={InputKeyUp}
    value={isAutoWord ? autoSearchWord : searchWord}
  />
)
```
```js
// src/hooks/useKeyEvent.js

  const KeyEvent = {
    ArrowDown: () => {
      if (searchList.length === 0) {
        return; // ë¦¬ìŠ¤íŠ¸ì˜ ê¸¸ì´ê°€ 0ì¸ ê²½ìš° return
      }
      if (listRef.current.childElementCount === focusIndex + 1) {
        setFocusIndex(() => 0);
        return;
      }
      if (focusIndex === -1) {
        setIsAutoWord(true); // ê²€ìƒ‰ì°½ì—ì„œ í‚¤ë³´ë“œë¥¼ ì›€ì§ì´ê¸° ì „ ìë™ì™„ì„± stateë¥¼ trueë¡œ ë³€ê²½
      }
      setFocusIndex(index => index + 1); // ë¦¬ìŠ¤íŠ¸ê°€ ë°°ì—´ë¡œ ë˜ì–´ ìˆì–´ ì•„ë˜ ë°©í–¥í‚¤ë¥¼ ëˆ„ë¥´ë©´ focusIndexê°€ -1ë¶€í„° 1ì”© ì¦ê°€
      setAutoSearchWord(searchList[focusIndex + 1]?.sickNm); // ìë™ì™„ì„±ì„ ìœ„í•´ stateì— focusë˜ì–´ ìˆëŠ” ì§ˆí™˜ëª…ìœ¼ë¡œ ë³€ê²½
    },
    ArrowUp: () => {
      if (focusIndex === -1) {
        return; // focusê°€ ì…ë ¥ì°½ì— ë¨¸ë¬¼ê³  ìˆë‹¤ë©´ return
      }
      if (focusIndex === 0) { // ë¦¬ìŠ¤íŠ¸ì˜ ì²«ë²ˆì§¸ ì§ˆí™˜ëª…ì— focusê°€ ë˜ì–´ ìˆëŠ” ê²½ìš° ìœ„ ë°©í–¥í‚¤ë¥¼ ëˆ„ë¥´ë©´ ìë™ì™„ì„± off -> ì…ë ¥ì°½ì—ëŠ” ì…ë ¥í•œ í‚¤ì›Œë“œê°€ ë³´ì—¬ì§‘ë‹ˆë‹¤.
        setAutoSearchWord('');
        setFocusIndex(index => index - 1);
        setIsAutoWord(false);
        return;
      }

      setFocusIndex(index => index - 1); // ë¦¬ìŠ¤íŠ¸ê°€ ë°°ì—´ë¡œ ë˜ì–´ ìˆì–´ ìœ„ ë°©í–¥í‚¤ë¥¼ ëˆ„ë¥´ë©´ focusIndexê°€ 1ì”© ê°ì†Œ
      setAutoSearchWord(searchList[focusIndex - 1].sickNm);
    },
    Escape: () => { // escë¥¼ ëˆ„ë¥´ë©´ focus off
      setAutoSearchWord('');
      setFocusIndex(-1);
      setIsAutoWord(false);
    },
  };

```
